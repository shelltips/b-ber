// `.figure__xx` classes are containers for figure elements. The
// `figure` element is styled immediately below.

//
// Element styles
//

figure {
    @include following-paragraph-not-indented;
    margin: 0 auto;
    padding: 0;
    img {
        display: inline-block;
        margin: 0 auto;
        vertical-align: top;
        width: 100%;
    }

    .figcaption,
    figcaption {
        @include following-paragraph-not-indented;
        display: inline-block;
        text-align: left;
        a {
            text-decoration: none;
        }
    }
}

.figure__small img {
}
.figure__medium img {
}
.figure__large img {
    &.landscape {
        width: 100%;
    }
}
.figure__inline img {
}

// Base container styles
.figure__small,
.figure__medium,
.figure__large,
.figure__inline {
    page-break-inside: avoid;
    text-align: center;
}

.figure__large {
    page-break-before: always;
    page-break-after: always;
    @include padding(
        1,
        0,
        1,
        0,
        0
    ); // Space is added in the event that readers don't respect the page-break atrribute.
}

// Basic spread styles
.spread {
    page-break-inside: avoid;
    page-break-before: always;
    page-break-after: always;
    section {
        padding:20% 20% 0 20%; // Basic centered spread layout.
    }
}

// Gallery Styling
// This sets up a layout for galleries that contains 12 columns and two rows and is responsive. See settings file to modify. 
section.gallery .figure__gallery {
    .figure__items {
        display: grid;
        grid-template: $grid-template;
        grid-gap: $grid-gap;
        height: 85vh;
        margin-top: 75px;
        padding: 0px;
        width: 85vw;
        .gallery__item {
            grid-column: span 4;
        }
    }
}

#layout.context__desktop {
    // desktop context only
    .figure__large,
    .spread {
        padding: 0;
    }
    .figure__large {
        -webkit-column-break-after: always;
        -webkit-column-break-before: always;
    }
    .figure__fullbleed {
        -webkit-column-break-before: avoid !important;
        -webkit-column-break-after: avoid !important;
    }
}

.figure__large.figure__inline {
    .epigraph & {
        margin-top: 0;
    }
}

// Containers for inline images (used in text flow)
.figure__small {
    // sizes for the images
    &.figure__small--landscape,
    &.figure__small--square,
    &.figure__small--portrait,
    &.figure__small--portrait-high {
        @include padding(1, 0, 1, 0, 0);
        h1 + & {
            padding-top: 0;
        }
        figure,
        a,
        img {
            width: auto;
        }
    }

    a {
        margin: 0 auto;
    }

    + blockquote,
    + blockquote.dialogue {
        padding-top: 0;
    }

    &.figure__small--landscape {
        figure,
        a,
        img {
            height: n-lines($landscape-image-height, 0);
        }
    }

    &.figure__small--square {
        figure,
        a,
        img {
            height: n-lines($square-image-height, 0);
        }
    }

    &.figure__small--portrait {
        figure,
        a,
        img {
            height: n-lines($portrait-image-height, 0);
        }
    }

    &.figure__small--portrait-high {
        figure,
        a,
        img {
            height: n-lines($portrait-image--high-height, 0);
        }
    }
}

// Images used in epigraph.
.figure__medium {
    text-align: center;
    page-break-inside: avoid;
    // height: 350px!important;
    height: n-ems(14, 0);

    .epigraph & {
        margin-top: 0 !important;
        padding-top: 0 !important;
        page-break-inside: avoid;
    }
}

// `figcaption` element and `.figcaption` class both refer to the same
// element because the `figcaption` element is not supported on some
// readers.
figcaption,
.figcaption {
    text-align: center;
    width: 100%;
    @include following-paragraph-not-indented;
    display: inline-block;
    a {
        text-decoration: none;
    }

    p.small {
        @include caption;
        width:90%;
    }

    .figure__large & {
    }

    .figure__fullbleed.figure__inline--landscape & {
        bottom: 70px;
        display: inline-block;
        left: 20px;
        margin: 0;
        padding: 0;
        position: absolute;  
    }
}

p.caption {
    @include caption;
}

.media__fallback__audio,
.media__fallback__video {
}

.media__fallback--image {
}

.media__fallback--text {
    @include caption;
}

// Inline figure sizes
.figure__items {
    width: 100%;
    margin: 0 auto;
    a {
        text-decoration: none !important;
    }
    .epigraph & {
        padding-top: 7px;
    }
    .figure__inline--square & {
        width: 80%;
    }
    .figure__inline--landscape & {
        width: 100%;
    }
    .figure__inline--portrait & {
        width: 60%;
    }
    .figure__inline--portrait-high & {
        width: 48%;
    }
}
